---
title: "Steam Sales Project"
author: Andrew Dai
date: 11.10.20
output:
  pdf_document:
    fig_caption: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(
ggplot2,
pwr,
ordinal,
lme4
)
```

## Abstract 


## Introduction

The video game industry has developed significantly since the rise of the home computer. One market in particular which has sprung onto mainstream audiences is the access to downloadable computer games. Valve is a game distributor, among many others, from whom players can purchase and download games. The proliferation of Valve is attributed to their ability to connect individuals on their online platform, Steam, and enable interaction between players. 

Developers publishing their work onto Steam can charge a one time fee for the indefinite access to their game. This access is typically restricted to the player's Steam account and intended for a single person.

With corporations such as Valve, Blizzard, Epic and Riot propping up these digital content markets with their own respecitve platforms, they provide audiences with an enormous library of computer games- a selection process which forces players to be more discriminating towards different titles. Not every game can be treated equally by the average gamer- the truth is that a majority of titles will probably go untested.

Price is one consideration players may have before they choose to purchase a game. When we invest ourselves in a game, we dedicate some amount of resource into actually playing the game through. With a free title, the only downside could be an hour or two of wasted time. However the more expensive a game is, we expect less players to be willing to invest in such a costly risk and so we expect smaller ownership of that title.

Number of players is important for players who value multiplayer games. The most-owned games on Steam are typically massive multiplayer games where a large number of players contribute to the game's activity. More players often leads to a better experience as there is less waiting to begin a match. With a large playerbase, developers are also more likely to push new content and patch existing problems. As a result, games with large ownership tend to be higher rated than games with small ownership. 

Ratings are important to a prospective game buyer. Players are more likely to try a game with positive ratings and pass on a game with negative ratings. Ratings can reflect the value of the game, factoring in quality as well as cost. We can expect games with a large number of positive ratings to be 1) inexpensive and 2) with large ownership. 

As the industry attracts more attention from investors and developers alike, there is a growing interest in what makes certain titles so popular among audiences. Advertising on video game streams is one way that corporations target this audience group to purchase products they are likely to buy.

This report will investigate the question of what makes a game popular on Steam. We will use a multilevel linear model with random effects between game genres. The dataset was taken from the Steamspy API by Nik Davis who published it on Kaggle and performs Exploratory Data Analysis on his blog. (source) Davis has provided valuable insights through his visualization and this report intends to follow-up by 1) checking his EDA with our own and 2) fitting the data to a statistical model. 

## Methods 

## Results

## Discussion

## Bibliography

```{r}

steam <- read.csv("steam.csv")

cat("Steam dataset has",as.character(nrow(steam)),"rows and",as.character(ncol(steam)),"columns:","\n")
cat(names(steam), sep=", ")

# Data Cleaning

# lower bound of owners range taken for each value
steam$owners <- as.integer(gsub("([0-9]+).*$", "\\1", steam$owners))
steam$release_year <- as.integer(gsub("([0-9]+).*$", "\\1", steam$release_date))
steam$total_ratings <- steam$positive_ratings+steam$negative_ratings

steam$genres <- strsplit(steam$genres, ";")
number_of_genre_tags <- sapply(steam$genres,function(x) length(x))
steam <- steam[which(number_of_genre_tags==1),]
steam$genres <- unlist(steam$genres)
genre_tags <- c("Action", "Indie", "Strategy", "RPG", "Racing", "Casual", "Adventure", "Sports", "Simulation", "Free to Play")

steam <- steam[sort(unlist(sapply(1:10,function(x) which(steam$genres==genre_tags[x])))),]
rownames(steam) <- 1:nrow(steam)

# keeping only games with 1 genre tag for simplicity's sake
# because games with multiple genre tags may be overlapping in groups
# keeping only 10 genres of games: Action, Indie, Strategy, RPG, Racing, Casual, Adventure, Sports, Simulation and Free to Play
# there is one game: "ADR Labellling game" that is skewing our price, I will remove it because it's inclusion is not valuable to our analysis

plot(steam$price,jitter(log(steam$owners),2),xlim=c(0,80), main="Effect of price on log(owners)")
plot(jitter(steam$release_year,2),jitter(log(steam$owners),2), main="Effect of release year on log(owners)")
plot(log(steam$total_ratings),jitter(log(steam$owners),2), main="Effect of total ratings on log(owners)", ylab="log(owners)", xlab="")

```

```{r}
# EDA
# Question: What makes a game popular on Steam?
# Definition of popular: many regular players

# Hypothesis / Variable Selection
# Price could be a variable that makes a game popular because if price is lower or free, it allows more people to afford the game.
# Positive ratings could be a variable that makes a game popular because it advertises the game to new players.
# Modern games should have a greater ownership than games created when Steam was first launched. However, games that have
# been just released may see a lag time before they are able to reach stable levels of ownership.

# log(owners) ~ beta0 + beta1(price) + beta2(positive_ratings/(positive_ratings+negative_ratings)) + beta3(release_year)

#
ratings <- steam$positive_ratings/(steam$positive_ratings+steam$negative_ratings)
score <- (ratings -(ratings*0.5)*2^(-log(steam$total_ratings+1)))
steam$rating_score <- score*100

steam20 <- data.frame(owners=steam$owners, price=steam$price, ratings=steam$positive_ratings/(steam$positive_ratings+steam$negative_ratings),score=steam$rating_score, release_year=steam$release_year, genre=steam$genres)

# removing all games with less than 20000 owners
steam20 <- steam20[-which(steam20$owners==0),]
```

```{r}
ggplot(steam20, aes(y = score, x = price)) + geom_point() + geom_jitter() + 
  geom_smooth(method=lm) + xlim(0,60)

ggplot(steam20, aes(y = score, x = price, color = factor(genre))) + geom_point() + geom_jitter() + 
  geom_smooth(method=lm,alpha=0.2) + xlim(0,60)

ggplot(steam20, aes(y = score, x = log(owners))) + geom_point() + geom_jitter() + 
  geom_smooth(method=lm) 

ggplot(steam20, aes(y = score, x = log(owners), color = factor(genre))) + geom_point() + geom_jitter() + 
  geom_smooth(method=lm,alpha=0.2)

```

```{r}
#model fitting


```



